<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>cask &mdash; Cask 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Cask 1.0.0 documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Cask 1.0.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for cask</h1><div class="highlight"><pre>
<span></span><span class="c1">#-******************************************************************************</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2012-2015,</span>
<span class="c1">#  Sony Pictures Imageworks Inc. and</span>
<span class="c1">#  Industrial Light &amp; Magic, a division of Lucasfilm Entertainment Company Ltd.</span>
<span class="c1">#</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are</span>
<span class="c1"># met:</span>
<span class="c1"># *       Redistributions of source code must retain the above copyright</span>
<span class="c1"># notice, this list of conditions and the following disclaimer.</span>
<span class="c1"># *       Redistributions in binary form must reproduce the above</span>
<span class="c1"># copyright notice, this list of conditions and the following disclaimer</span>
<span class="c1"># in the documentation and/or other materials provided with the</span>
<span class="c1"># distribution.</span>
<span class="c1"># *       Neither the name of Sony Pictures Imageworks, nor</span>
<span class="c1"># Industrial Light &amp; Magic, nor the names of their contributors may be used</span>
<span class="c1"># to endorse or promote products derived from this software without specific</span>
<span class="c1"># prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<span class="c1"># &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<span class="c1"># LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<span class="c1"># A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<span class="c1"># OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<span class="c1"># SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<span class="c1"># LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<span class="c1"># DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<span class="c1"># THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<span class="c1"># (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="c1">#</span>
<span class="c1">#-******************************************************************************</span>

<span class="n">__doc__</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Cask is a high level convenience wrapper for the Alembic Python API. It blurs</span>
<span class="s2">the lines between Alembic &quot;I&quot; and &quot;O&quot; objects and properties, abstracting both</span>
<span class="s2">into a single class object. It also wraps up a number of lower-level functions</span>
<span class="s2">into high level convenience methods.</span>

<span class="s2">More information can be found at http://docs.alembic.io/python/cask.html</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;0.9.6g&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">imath</span>
<span class="kn">import</span> <span class="nn">ctypes</span>
<span class="kn">import</span> <span class="nn">weakref</span>
<span class="kn">import</span> <span class="nn">alembic</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>

<span class="c1"># maps cask objects to Alembic IObjects</span>
<span class="n">IOBJECTS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Camera&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">ICamera</span><span class="p">,</span>
    <span class="s2">&quot;Collections&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcCollection</span><span class="o">.</span><span class="n">ICollections</span><span class="p">,</span>
    <span class="s2">&quot;Curve&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">ICurves</span><span class="p">,</span>
    <span class="s2">&quot;FaceSet&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">IFaceSet</span><span class="p">,</span>
    <span class="s2">&quot;Light&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">ILight</span><span class="p">,</span>
    <span class="s2">&quot;Material&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcMaterial</span><span class="o">.</span><span class="n">IMaterial</span><span class="p">,</span>
    <span class="s2">&quot;NuPatch&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">INuPatch</span><span class="p">,</span>
    <span class="s2">&quot;Points&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">IPoints</span><span class="p">,</span>
    <span class="s2">&quot;PolyMesh&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">IPolyMesh</span><span class="p">,</span>
    <span class="s2">&quot;SubD&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">ISubD</span><span class="p">,</span>
    <span class="s2">&quot;Xform&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">IXform</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># maps cask objects to Alembic OObjects</span>
<span class="n">OOBJECTS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Camera&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">OCamera</span><span class="p">,</span>
    <span class="s2">&quot;Collections&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcCollection</span><span class="o">.</span><span class="n">OCollections</span><span class="p">,</span>
    <span class="s2">&quot;Curve&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">OCurves</span><span class="p">,</span>
    <span class="s2">&quot;FaceSet&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">OFaceSet</span><span class="p">,</span>
    <span class="s2">&quot;Light&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">OLight</span><span class="p">,</span>
    <span class="s2">&quot;Material&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcMaterial</span><span class="o">.</span><span class="n">OMaterial</span><span class="p">,</span>
    <span class="s2">&quot;NuPatch&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">ONuPatch</span><span class="p">,</span>
    <span class="s2">&quot;Points&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">OPoints</span><span class="p">,</span>
    <span class="s2">&quot;PolyMesh&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">OPolyMesh</span><span class="p">,</span>
    <span class="s2">&quot;SubD&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">OSubD</span><span class="p">,</span>
    <span class="s2">&quot;Xform&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">OXform</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># maps cask objects to Alembic IObject schemas</span>
<span class="n">ISCHEMAS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Camera&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">ICameraSchema</span><span class="p">,</span>
    <span class="s2">&quot;Collections&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcCollection</span><span class="o">.</span><span class="n">ICollectionsSchema</span><span class="p">,</span>
    <span class="s2">&quot;Curve&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">ICurvesSchema</span><span class="p">,</span>
    <span class="s2">&quot;FaceSet&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">IFaceSetSchema</span><span class="p">,</span>
    <span class="s2">&quot;Light&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">ILightSchema</span><span class="p">,</span>
    <span class="s2">&quot;Material&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcMaterial</span><span class="o">.</span><span class="n">IMaterialSchema</span><span class="p">,</span>
    <span class="s2">&quot;NuPatch&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">INuPatchSchema</span><span class="p">,</span>
    <span class="s2">&quot;Points&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">IPointsSchema</span><span class="p">,</span>
    <span class="s2">&quot;PolyMesh&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">IPolyMeshSchema</span><span class="p">,</span>
    <span class="s2">&quot;SubD&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">ISubDSchema</span><span class="p">,</span>
    <span class="s2">&quot;Xform&quot;</span><span class="p">:</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">IXformSchema</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">int8</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int8</span><span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

<span class="k">def</span> <span class="nf">int16</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int16</span><span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="mh">0xffff</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

<span class="k">def</span> <span class="nf">int32</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

<span class="k">def</span> <span class="nf">int64</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int64</span><span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="mh">0xffffffffffffffff</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

<span class="k">def</span> <span class="nf">uint8</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint8</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

<span class="k">def</span> <span class="nf">uint16</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

<span class="k">def</span> <span class="nf">uint32</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint32</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

<span class="k">def</span> <span class="nf">uint64</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint64</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

<span class="c1"># Python class mapping to Imath array class</span>
<span class="n">IMATH_ARRAYS_BY_TYPE</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nb">bool</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">BoolArray</span><span class="p">,</span>
    <span class="nb">float</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">FloatArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Box2d</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">Box2dArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Box2f</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">Box2fArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Box2i</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">Box2iArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Box2s</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">Box2sArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Box3d</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">Box3dArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Box3f</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">Box3fArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Box3i</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">Box3iArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Box3s</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">Box3sArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Color3c</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">C3cArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Color3f</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">C3fArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Color4c</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">C4cArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Color4f</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">C4fArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">M33d</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">M33dArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">M33f</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">M33fArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">M44d</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">M44dArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">M44f</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">M44fArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">V2d</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">V2dArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">V2f</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">V2fArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">V2i</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">V2iArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">V2s</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">V2sArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">V3d</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">V3dArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">V3f</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">V3fArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">V3i</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">V3iArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">V3s</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">V3sArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">V4d</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">V4dArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">V4f</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">V4fArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">V4i</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">V4iArray</span><span class="p">,</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">V4s</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">V4sArray</span><span class="p">,</span>
    <span class="nb">int</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">IntArray</span><span class="p">,</span>
    <span class="nb">str</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">StringArray</span><span class="p">,</span>
    <span class="n">uint8</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">UnsignedCharArray</span><span class="p">,</span>
    <span class="n">uint16</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">UnsignedShortArray</span><span class="p">,</span>
    <span class="n">uint32</span><span class="p">:</span> <span class="n">imath</span><span class="o">.</span><span class="n">UnsignedIntArray</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Python class mapping to Alembic POD, extent</span>
<span class="n">POD_EXTENT</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nb">bool</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kBooleanPOD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">uint8</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kUint8POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">int8</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kInt8POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">uint16</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kUint16POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">int16</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kInt16POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">uint32</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kUint32POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="nb">int</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kInt32POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">int32</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kInt32POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">uint64</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kUint64POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">int64</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kInt64POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="c1">#float: (alembic.Util.POD.kFloat16POD, -1),</span>
    <span class="c1">#float: (alembic.Util.POD.kFloat32POD, -1),</span>
    <span class="nb">float</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kFloat64POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="nb">str</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kStringPOD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="c1">#str: (alembic.Util.POD.kWstringPOD, -1),</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">V3f</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kFloat32POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Color3c</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kUint8POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Color3f</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kFloat32POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Color4c</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kUint8POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Color4f</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kFloat32POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Box3f</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kFloat32POD</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">Box3d</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kFloat64POD</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">M33f</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kFloat32POD</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">M33d</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kFloat64POD</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">M44f</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kFloat32POD</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">M44d</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kFloat64POD</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">StringArray</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kStringPOD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">UnsignedCharArray</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kUint8POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="c1">#imath.UnsignedIntArray: (alembic.Util.POD.kUint32POD, -1),</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">IntArray</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kInt32POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">FloatArray</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kFloat32POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">imath</span><span class="o">.</span><span class="n">DoubleArray</span><span class="p">:</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kFloat64POD</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="c1">#: (alembic.Util.POD.kNumPlainOldDataTypes, -1),</span>
    <span class="c1">#: (alembic.Util.POD.kUnknownPOD, -1),</span>
<span class="p">}</span>

<span class="n">_COMPOUND_PROPERTY_VALUE_ERROR_</span> <span class="o">=</span> <span class="s2">&quot;Compound properties cannot have values&quot;</span>

<span class="k">def</span> <span class="nf">get_simple_oprop_class</span><span class="p">(</span><span class="n">prop</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the alembic simple property class based on a given name and value.</span>

<span class="sd">    :param prop: Property object</span>
<span class="sd">    :return: Alembic OProperty class</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">is_compound</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">alembic</span><span class="o">.</span><span class="n">Abc</span><span class="o">.</span><span class="n">OCompoundProperty</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
        <span class="n">is_array</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">isArray</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">is_array</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">set</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> 
    <span class="k">if</span> <span class="n">is_array</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">alembic</span><span class="o">.</span><span class="n">Abc</span><span class="o">.</span><span class="n">OArrayProperty</span>
    <span class="k">return</span> <span class="n">alembic</span><span class="o">.</span><span class="n">Abc</span><span class="o">.</span><span class="n">OScalarProperty</span>

<span class="k">def</span> <span class="nf">_delist</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns single value if list len is 1&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">set</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">val</span>

<span class="k">def</span> <span class="nf">python_to_imath</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts Python lists to Imath arrays.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">IMATH_ARRAYS_BY_TYPE</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">value</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">_delist</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="n">is_array</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="n">value0</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">is_array</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">value</span>
    <span class="k">if</span> <span class="n">is_array</span><span class="p">:</span>
        <span class="n">new_value</span> <span class="o">=</span> <span class="n">IMATH_ARRAYS_BY_TYPE</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value0</span><span class="p">))(</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="n">new_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">return</span> <span class="n">new_value</span>
    <span class="k">return</span> <span class="n">value</span>

<span class="k">def</span> <span class="nf">get_pod_extent</span><span class="p">(</span><span class="n">prop</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns POD, extent tuple for given Property.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">_delist</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">is_array</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="n">value0</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">is_array</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">value</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pod</span><span class="p">,</span> <span class="n">extent</span> <span class="o">=</span> <span class="n">POD_EXTENT</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value0</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;Error getting pod, extent from&quot;</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">value0</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">POD</span><span class="o">.</span><span class="n">kUnknownPOD</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">extent</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
       <span class="n">extent</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">value0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">is_scalar</span><span class="p">()</span> <span class="ow">and</span>
            <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value0</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value0</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">))</span>
            <span class="k">else</span> <span class="mi">1</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">pod</span><span class="p">,</span> <span class="n">extent</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">wrapped</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This decorator function decorates Object methods that require</span>
<span class="sd">    access to the alembic schema class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">with_wrapped_object</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;wraps internal alembic iobject&quot;&quot;&quot;</span>
        <span class="n">iobj</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iobject</span>
        <span class="k">for</span> <span class="n">klass</span> <span class="ow">in</span> <span class="n">IOBJECTS</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">iobj</span> <span class="ow">and</span> <span class="n">klass</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">iobj</span><span class="o">.</span><span class="n">getMetaData</span><span class="p">()):</span>
                <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iobject</span> <span class="o">=</span> <span class="n">klass</span><span class="p">(</span><span class="n">iobj</span><span class="o">.</span><span class="n">getParent</span><span class="p">(),</span> <span class="n">iobj</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">with_wrapped_object</span>

<span class="k">def</span> <span class="nf">wrap</span><span class="p">(</span><span class="n">iobject</span><span class="p">,</span> <span class="n">time_sampling_id</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a cask-wrapped class object based on the class method &quot;matches&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">iobject</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;ABC&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Top</span><span class="p">(</span><span class="n">iobject</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cls</span> <span class="ow">in</span> <span class="n">Object</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">cls</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">iobject</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">iobject</span><span class="p">,</span> <span class="n">time_sampling_id</span><span class="o">=</span><span class="n">time_sampling_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Object</span><span class="p">(</span><span class="n">iobject</span><span class="p">)</span>

<div class="viewcode-block" id="is_valid"><a class="viewcode-back" href="../index.html#cask.is_valid">[docs]</a><span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="n">archive</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns True if the archive is a valid alembic archive.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">alembic</span><span class="o">.</span><span class="n">Abc</span><span class="o">.</span><span class="n">IArchive</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span></div>

<div class="viewcode-block" id="find"><a class="viewcode-back" href="../index.html#cask.find">[docs]</a><span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;.*&quot;</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds and returns a list of Objects with names matching</span>
<span class="sd">    a given regular expression. ::</span>

<span class="sd">        &gt;&gt;&gt; find(a.top, &quot;.*Shape&quot;)</span>
<span class="sd">        [&lt;PolyMesh &quot;cube1Shape&quot;&gt;, &lt;PolyMesh &quot;cube2Shape&quot;&gt;]</span>

<span class="sd">    :param name: Regular expression to match object name</span>
<span class="sd">    :param types: Class type inclusion list</span>
<span class="sd">    :return: Sorted list of Object results</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">find_iter</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">types</span><span class="p">)]</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="find_iter"><a class="viewcode-back" href="../index.html#cask.find_iter">[docs]</a><span class="k">def</span> <span class="nf">find_iter</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;.*&quot;</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generator that yields Objects with names matching</span>
<span class="sd">    a given regular expression.</span>

<span class="sd">    :param name: Regular expression to match object name</span>
<span class="sd">    :param types: Class type inclusion list</span>
<span class="sd">    :yields: Object with name matching name regex</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">types</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">obj</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="ow">in</span> <span class="n">types</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">obj</span>
    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">grandchild</span> <span class="ow">in</span> <span class="n">find_iter</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">grandchild</span></div>

<span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">copy</span> <span class="kn">as</span> <span class="nn">_copy</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="n">item</span><span class="o">.</span><span class="n">name</span>
    <span class="n">new_item</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
        <span class="n">new_item</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">_copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">_iobject</span><span class="p">:</span>
        <span class="n">new_item</span><span class="o">.</span><span class="n">_iobject</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">_iobject</span>
    <span class="n">new_item</span><span class="o">.</span><span class="n">time_sampling_id</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">time_sampling_id</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">in</span> <span class="n">Object</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">new_item</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">child</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">new_item</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">prop</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="n">Property</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">datatype</span><span class="p">:</span>
            <span class="n">new_item</span><span class="o">.</span><span class="n">datatype</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">datatype</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">new_item</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">prop</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_item</span>

<span class="k">def</span> <span class="nf">_deep_getitem</span><span class="p">(</span><span class="n">access_func</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Facilitates deep dict get item on DeepDict class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">split_key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">split_key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">rest</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">split_key</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">return</span> <span class="n">access_func</span><span class="p">(</span><span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">get_item</span><span class="p">(</span><span class="n">rest</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">DeepDict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Special dict subclass that allows deep dictionary access, renaming when</span>
<span class="sd">    setting items and reflective reparenting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">klass</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DeepDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">klass</span> <span class="o">=</span> <span class="n">klass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visited</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">):</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">):</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;/&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_deep_getitem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">DeepDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">item</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
                <span class="k">return</span> <span class="n">item</span>

    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">klass</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">klass</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid item class: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="o">.</span><span class="n">type</span><span class="p">())</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
        <span class="n">new</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="s2">&quot;/&quot;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">names</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="n">Property</span><span class="p">:</span>
                        <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="c1"># automatically create missing nodes</span>
                    <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="n">names</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="n">Property</span><span class="p">:</span>
                            <span class="n">child</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">Property</span><span class="p">()</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">child</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">Xform</span><span class="p">()</span>
                        <span class="n">child</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">obj</span>
                        <span class="n">obj</span> <span class="o">=</span> <span class="n">child</span>
                    <span class="n">new</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="n">new</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">parent</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">set_item</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
      
        <span class="n">item</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">item</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visited</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">DeepDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes an item if it exists.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<div class="viewcode-block" id="Archive"><a class="viewcode-back" href="../index.html#cask.Archive">[docs]</a><span class="k">class</span> <span class="nc">Archive</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Archive I/O Object&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">24</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new Archive class object.</span>

<span class="sd">        :param filepath: Path to Alembic archive file.</span>
<span class="sd">        :param fps: Frames per second (default 24).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">filepath</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Nonexistent file: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">filepath</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># internal object attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iobject</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_top</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># time sampling attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_sampling_id</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fps</span> <span class="o">=</span> <span class="n">fps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__start_time</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__end_time</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># read in the archive</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__read_from_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;</span><span class="si">%s</span><span class="s1"> &quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">id</span>

    <span class="k">def</span> <span class="nf">__get_iobject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets iobject&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iobject</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_iobject</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">Abc</span><span class="o">.</span><span class="n">IArchive</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iobject</span>

    <span class="k">def</span> <span class="nf">__set_iobject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iobject</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets iobject&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iobject</span> <span class="o">=</span> <span class="n">iobject</span>

    <span class="n">iobject</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_iobject</span><span class="p">,</span> <span class="n">__set_iobject</span><span class="p">,</span>
                       <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Internal Alembic IArchive object.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__get_oobject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets oobject&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">Abc</span><span class="o">.</span><span class="n">OArchive</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span> <span class="n">asOgawa</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">oobject</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span><span class="o">.</span><span class="n">getTop</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span>

    <span class="k">def</span> <span class="nf">__set_oobject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oobject</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets oobject&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="n">oobject</span>

    <span class="n">oobject</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_oobject</span><span class="p">,</span> <span class="n">__set_oobject</span><span class="p">,</span>
                       <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Internal Alembic OArchive object.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__get_top</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets the top object&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_top</span> <span class="o">=</span> <span class="n">Top</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_top</span> <span class="o">=</span> <span class="n">Top</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getTop</span><span class="p">())</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oobject</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_top</span> <span class="o">=</span> <span class="n">Top</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oobject</span><span class="o">.</span><span class="n">getTop</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_top</span><span class="o">.</span><span class="n">oobject</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oobject</span><span class="o">.</span><span class="n">getTop</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top</span>

    <span class="k">def</span> <span class="nf">__set_top</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets the top object&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_top</span> <span class="o">=</span> <span class="n">top</span>

    <span class="n">top</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_top</span><span class="p">,</span> <span class="n">__set_top</span><span class="p">,</span>
                   <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Hierarchy root, cask.Top object.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__read_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads and sets the internal IArchive object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">filepath</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oobject</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__get_iobject</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__time_sampling_objects</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_sampling_id</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timesamplings</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<div class="viewcode-block" id="Archive.info"><a class="viewcode-back" href="../index.html#cask.Archive.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a metadata dictionary.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">alembic</span><span class="o">.</span><span class="n">Abc</span><span class="o">.</span><span class="n">GetArchiveInfo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">)</span></div>

<div class="viewcode-block" id="Archive.alembic_version"><a class="viewcode-back" href="../index.html#cask.Archive.alembic_version">[docs]</a>    <span class="k">def</span> <span class="nf">alembic_version</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the version of alembic used to write this archive.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;libraryVersionString&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">r&quot;\d.\d.\d&quot;</span><span class="p">,</span> <span class="n">version</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="Archive.using_version"><a class="viewcode-back" href="../index.html#cask.Archive.using_version">[docs]</a>    <span class="k">def</span> <span class="nf">using_version</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the version of alembic used to read this archive.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">alembic</span><span class="o">.</span><span class="n">Abc</span><span class="o">.</span><span class="n">GetLibraryVersionShort</span><span class="p">()</span></div>

<div class="viewcode-block" id="Archive.type"><a class="viewcode-back" href="../index.html#cask.Archive.type">[docs]</a>    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns &quot;Archive&quot;.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span></div>

<div class="viewcode-block" id="Archive.path"><a class="viewcode-back" href="../index.html#cask.Archive.path">[docs]</a>    <span class="k">def</span> <span class="nf">path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the filepath for this Archive.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span></div>

<div class="viewcode-block" id="Archive.is_leaf"><a class="viewcode-back" href="../index.html#cask.Archive.is_leaf">[docs]</a>    <span class="k">def</span> <span class="nf">is_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns False.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">False</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the basename of this archive.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">timesamplings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generator that yields tuples of (index, TimeSampling) objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__time_sampling_objects</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
            <span class="n">iarch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span>
            <span class="n">num_samples</span> <span class="o">=</span> <span class="n">iarch</span><span class="o">.</span><span class="n">getNumTimeSamplings</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">iarch</span><span class="o">.</span><span class="n">getTimeSampling</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__time_sampling_objects</span>

    <span class="k">def</span> <span class="nf">add_timesampling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ts</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timesamplings</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__time_sampling_objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__start_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__end_time</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timesamplings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>

<div class="viewcode-block" id="Archive.time_range"><a class="viewcode-back" href="../index.html#cask.Archive.time_range">[docs]</a>    <span class="k">def</span> <span class="nf">time_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a tuple of the global start and end time in seconds.</span>

<span class="sd">        ** Depends on the X.samples property being set on the Top node,</span>
<span class="sd">        which is currently being written by Maya only. **</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">top_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">properties</span>
        <span class="n">g_start_frame</span><span class="p">,</span> <span class="n">g_end_time</span> <span class="o">=</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__start_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__end_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__start_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__end_time</span><span class="p">)</span>

        <span class="n">num_stored_times</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timesamplings</span><span class="p">):</span>
            <span class="n">tst</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">getTimeSamplingType</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">tst</span><span class="o">.</span><span class="n">isCyclic</span><span class="p">()</span> <span class="ow">or</span> <span class="n">tst</span><span class="o">.</span><span class="n">isUniform</span><span class="p">():</span>
                <span class="n">tpc</span> <span class="o">=</span> <span class="n">tst</span><span class="o">.</span><span class="n">getNumSamplesPerCycle</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__start_time</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">getStoredTimes</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__end_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__start_time</span> <span class="o">+</span>\
                    <span class="p">(((</span><span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getMaxNumSamplesForTimeSamplingIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">/</span> <span class="n">tpc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>\
                    <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">tst</span><span class="o">.</span><span class="n">isAcyclic</span><span class="p">():</span>
                <span class="n">num_times</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">getNumStoredTimes</span><span class="p">()</span>
                <span class="n">num_stored_times</span> <span class="o">=</span> <span class="n">num_times</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__start_time</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">getSampleTime</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__end_time</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">getSampleTime</span><span class="p">(</span><span class="n">num_times</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__start_time</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__start_time</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__end_time</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__end_time</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__start_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__end_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Archive.start_time"><a class="viewcode-back" href="../index.html#cask.Archive.start_time">[docs]</a>    <span class="k">def</span> <span class="nf">start_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the global start time in seconds.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_range</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Archive.set_start_time"><a class="viewcode-back" href="../index.html#cask.Archive.set_start_time">[docs]</a>    <span class="k">def</span> <span class="nf">set_start_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the start time in seconds.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__start_time</span> <span class="o">=</span> <span class="n">start</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__end_time</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__end_time</span> <span class="o">=</span> <span class="n">start</span></div>

<div class="viewcode-block" id="Archive.start_frame"><a class="viewcode-back" href="../index.html#cask.Archive.start_frame">[docs]</a>    <span class="k">def</span> <span class="nf">start_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the start frame.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">)</span></div>

<div class="viewcode-block" id="Archive.set_start_frame"><a class="viewcode-back" href="../index.html#cask.Archive.set_start_frame">[docs]</a>    <span class="k">def</span> <span class="nf">set_start_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the start frame.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__start_time</span> <span class="o">=</span> <span class="n">frame</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">)</span></div>

<div class="viewcode-block" id="Archive.end_time"><a class="viewcode-back" href="../index.html#cask.Archive.end_time">[docs]</a>    <span class="k">def</span> <span class="nf">end_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the global end time in seconds.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_range</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="Archive.end_frame"><a class="viewcode-back" href="../index.html#cask.Archive.end_frame">[docs]</a>    <span class="k">def</span> <span class="nf">end_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the last frame.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_time</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">)</span></div>

<div class="viewcode-block" id="Archive.frame_range"><a class="viewcode-back" href="../index.html#cask.Archive.frame_range">[docs]</a>    <span class="k">def</span> <span class="nf">frame_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a tuple of the global start and end times in frames.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_frame</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_frame</span><span class="p">())</span></div>

<div class="viewcode-block" id="Archive.close"><a class="viewcode-back" href="../index.html#cask.Archive.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Closes this archive and makes it immutable.&quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">close_tree</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;recursive close&quot;&quot;&quot;</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">close_tree</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">child</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">del</span> <span class="n">obj</span>

        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">close_tree</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">child</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_iobject</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_top</span><span class="o">.</span><span class="n">_iobject</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_top</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_top</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_top</span><span class="o">.</span><span class="n">_child_dict</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_top</span><span class="o">.</span><span class="n">_prop_dict</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recursively calls save() on object hierarchy. Normally, you will</span>
<span class="sd">        want to call write_to_file instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">oobject</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No output filepath specified&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">def</span> <span class="nf">save_tree</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;recursive save&quot;&quot;&quot;</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">save_tree</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                <span class="n">child</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">del</span> <span class="n">child</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">del</span> <span class="n">obj</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">save_tree</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># TODO: non-destructive saving (changes are lost)</span>
<div class="viewcode-block" id="Archive.write_to_file"><a class="viewcode-back" href="../index.html#cask.Archive.write_to_file">[docs]</a>    <span class="k">def</span> <span class="nf">write_to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">asOgawa</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes this archive to a file on disk and closes the Archive.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">smps</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># look for timesampling data on the iarchive first</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">oobject</span><span class="p">:</span>
            <span class="n">smps</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">ts</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timesamplings</span><span class="p">)]</span>
        <span class="c1"># is none exist, create a new one</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">smps</span><span class="p">:</span>
            <span class="n">smps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcCoreAbstract</span><span class="o">.</span><span class="n">TimeSampling</span><span class="p">(</span>
                         <span class="mi">1</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">())))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_sampling_id</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># create the oarchive</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">oobject</span><span class="p">:</span>
            <span class="c1"># support for Ogawa archives via CreateArchiveWithInfo</span>
            <span class="c1"># came in Alembic 1.5.7</span>
            <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">m3</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">using_version</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">m1</span> <span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">m2</span> <span class="o">&lt;=</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">m3</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">oobject</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">Abc</span><span class="o">.</span><span class="n">OArchive</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">asOgawa</span><span class="o">=</span><span class="n">asOgawa</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
                    <span class="n">md</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getMetaData</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">md</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcCoreAbstract</span><span class="o">.</span><span class="n">MetaData</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">md</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">oobject</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">Abc</span><span class="o">.</span><span class="n">CreateArchiveWithInfo</span><span class="p">(</span>
                    <span class="n">filepath</span><span class="p">,</span>
                    <span class="s2">&quot;cask </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">__version__</span><span class="p">,</span>
                    <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="c1">#str(self.top.metadata),</span>
                    <span class="n">md</span><span class="p">,</span> <span class="mi">1</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">oobject</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oobject</span><span class="o">.</span><span class="n">getTop</span><span class="p">()</span>
        <span class="c1"># set timesampling objects on the oarchive</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">time_sample</span> <span class="ow">in</span> <span class="n">smps</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oobject</span><span class="o">.</span><span class="n">addTimeSampling</span><span class="p">(</span><span class="n">time_sample</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__write</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div></div>

<div class="viewcode-block" id="Property"><a class="viewcode-back" href="../index.html#cask.Property">[docs]</a><span class="k">class</span> <span class="nc">Property</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Property I/O Object.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iproperty</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">time_sampling_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">klass</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param iproperty: Alembic IProperty class object.</span>
<span class="sd">        :param time_sampling_id: TimeSampling object ID (inherits down).</span>
<span class="sd">        :param name: Property name</span>
<span class="sd">        :param klass: OProperty class used for writing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Property</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># init some private variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datatype</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iobject</span> <span class="o">=</span> <span class="n">iproperty</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span> <span class="o">=</span> <span class="n">klass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prop_dict</span> <span class="o">=</span> <span class="n">DeepDict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Property</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_sampling_id</span> <span class="o">=</span> <span class="n">time_sampling_id</span>

        <span class="c1"># if we have an iproperty, get some values from it</span>
        <span class="k">if</span> <span class="n">iproperty</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__read_property</span><span class="p">(</span><span class="n">iproperty</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;Property &quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<div class="viewcode-block" id="Property.get_item"><a class="viewcode-back" href="../index.html#cask.Property.get_item">[docs]</a>    <span class="k">def</span> <span class="nf">get_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;used for deep dict access&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">item</span><span class="p">]</span></div>

<div class="viewcode-block" id="Property.set_item"><a class="viewcode-back" href="../index.html#cask.Property.set_item">[docs]</a>    <span class="k">def</span> <span class="nf">set_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;used for deep dict access&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span></div>

    <span class="k">def</span> <span class="nf">__get_iobject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets iproperty&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iobject</span>

    <span class="k">def</span> <span class="nf">__set_iobject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iobject</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets iproperty&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iobject</span> <span class="o">=</span> <span class="n">iobject</span>

    <span class="n">iobject</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_iobject</span><span class="p">,</span> <span class="n">__set_iobject</span><span class="p">,</span>
                       <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Internal Alembic IProperty object.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__get_oobject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets oproperty&quot;&quot;&quot;</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
                <span class="n">meta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getMetaData</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">meta</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcCoreAbstract</span><span class="o">.</span><span class="n">MetaData</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">meta</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span> <span class="o">=</span> <span class="n">get_simple_oprop_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_compound</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
                <span class="n">meta</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;schema&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getMetaData</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;schema&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">==</span> <span class="n">Property</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">is_compound</span><span class="p">():</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">oobject</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">oobject</span><span class="p">,</span> <span class="s1">&#39;getProperties&#39;</span><span class="p">):</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">oobject</span><span class="o">.</span><span class="n">getProperties</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">parent</span> <span class="ow">and</span> <span class="n">parent</span><span class="o">.</span><span class="n">getPropertyHeader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="c1"># pre-existing property exists, see Property.__get_oobject</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">parent</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_compound</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span><span class="p">(</span>
                        <span class="n">parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_sampling_id</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span><span class="p">(</span>
                        <span class="n">parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_sampling_id</span>
                    <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span>

    <span class="k">def</span> <span class="nf">__set_oobject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oobject</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets oproperty&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="n">oobject</span>

    <span class="n">oobject</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_oobject</span><span class="p">,</span> <span class="n">__set_oobject</span><span class="p">,</span>
                       <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Internal Alembic OProperty object.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_scalar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span> <span class="o">=</span> <span class="n">get_simple_oprop_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span> <span class="o">==</span> <span class="n">alembic</span><span class="o">.</span><span class="n">Abc</span><span class="o">.</span><span class="n">OScalarProperty</span>

    <span class="k">def</span> <span class="nf">is_array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_scalar</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__get_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets parent&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getParent</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>

    <span class="k">def</span> <span class="nf">__set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets parent&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>

    <span class="n">parent</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_parent</span><span class="p">,</span> <span class="n">__set_parent</span><span class="p">,</span>
                      <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Parent object or property.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets name&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="k">def</span> <span class="nf">__set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets name&quot;&quot;&quot;</span>
        <span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">,</span> <span class="s2">&quot;_prop_dict&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">old</span> <span class="ow">and</span> <span class="n">old</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">old</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="n">name</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_name</span><span class="p">,</span> <span class="n">__set_name</span><span class="p">,</span>
                    <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Gets and sets the property name.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns metadata dict.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
            <span class="n">meta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getMetaData</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">meta</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">):</span>
                <span class="n">splits</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_ai_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;=&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span>

    <span class="k">def</span> <span class="nf">__set_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets metadata dict.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">metadata</span>

    <span class="n">metadata</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_metadata</span><span class="p">,</span> <span class="n">__set_metadata</span><span class="p">,</span>
                        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Metadata as a dict.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__get_datatype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the datatype object.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_datatype</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_datatype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getDataType</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">pod</span><span class="p">,</span> <span class="n">extent</span> <span class="o">=</span> <span class="n">get_pod_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pod</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unknown datatype for </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span> 
                        <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_datatype</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcCoreAbstract</span><span class="o">.</span><span class="n">DataType</span><span class="p">(</span><span class="n">pod</span><span class="p">,</span> <span class="n">extent</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_datatype</span>

    <span class="k">def</span> <span class="nf">__set_datatype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datatype</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the datatype object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datatype</span> <span class="o">=</span> <span class="n">datatype</span>

    <span class="n">datatype</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_datatype</span><span class="p">,</span> <span class="n">__set_datatype</span><span class="p">,</span>
                        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;DataType object.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Property.type"><a class="viewcode-back" href="../index.html#cask.Property.type">[docs]</a>    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the name of the class.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_compound</span><span class="p">():</span>
            <span class="k">return</span> <span class="s2">&quot;Compound Property&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span></div>

<div class="viewcode-block" id="Property.pod"><a class="viewcode-back" href="../index.html#cask.Property.pod">[docs]</a>    <span class="k">def</span> <span class="nf">pod</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the property&#39;s datatype POD value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="o">.</span><span class="n">getPod</span><span class="p">()</span></div>

<div class="viewcode-block" id="Property.extent"><a class="viewcode-back" href="../index.html#cask.Property.extent">[docs]</a>    <span class="k">def</span> <span class="nf">extent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the property&#39;s datatype extent.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="o">.</span><span class="n">getExtent</span><span class="p">()</span></div>

<div class="viewcode-block" id="Property.archive"><a class="viewcode-back" href="../index.html#cask.Property.archive">[docs]</a>    <span class="k">def</span> <span class="nf">archive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the Archive for this property.&quot;&quot;&quot;</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">while</span> <span class="n">parent</span> <span class="ow">and</span> <span class="n">parent</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;Archive&quot;</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">return</span> <span class="n">parent</span></div>

<div class="viewcode-block" id="Property.path"><a class="viewcode-back" href="../index.html#cask.Property.path">[docs]</a>    <span class="k">def</span> <span class="nf">path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the full path/name of this property.&quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">while</span> <span class="n">obj</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;Top&quot;</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">return</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="Property.object"><a class="viewcode-back" href="../index.html#cask.Property.object">[docs]</a>    <span class="k">def</span> <span class="nf">object</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the object parent for this property.&quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">while</span> <span class="n">obj</span> <span class="ow">and</span> <span class="s2">&quot;Property&quot;</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">type</span><span class="p">():</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="Property.add_property"><a class="viewcode-back" href="../index.html#cask.Property.add_property">[docs]</a>    <span class="k">def</span> <span class="nf">add_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a property to this, making this property a compound property.</span>

<span class="sd">        :param property: cask.Property class object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Properties with values cannot have sub-properies&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">prop</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">prop</span></div>

    <span class="k">def</span> <span class="nf">__read_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iproperty</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the internal IProperty object.</span>

<span class="sd">        :param iproperty: Alembic IProperty object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">iproperty</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span> <span class="o">=</span> <span class="n">iproperty</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">iproperty</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">iproperty</span><span class="o">.</span><span class="n">isCompound</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getNumProperties</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_property</span><span class="p">(</span><span class="n">Property</span><span class="p">(</span>
                        <span class="n">iproperty</span> <span class="o">=</span> <span class="n">iproperty</span><span class="o">.</span><span class="n">getProperty</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                        <span class="n">time_sampling_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_sampling_id</span>
                    <span class="p">)</span>
                 <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Child properties accessor.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prop_dict</span>

<div class="viewcode-block" id="Property.is_leaf"><a class="viewcode-back" href="../index.html#cask.Property.is_leaf">[docs]</a>    <span class="k">def</span> <span class="nf">is_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if this property is a leaf node, i.e. it has no sub-properties.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="Property.is_compound"><a class="viewcode-back" href="../index.html#cask.Property.is_compound">[docs]</a>    <span class="k">def</span> <span class="nf">is_compound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if this property contains sub-properties.</span>

<span class="sd">        Note that compound properties cannot have values, and</span>
<span class="sd">        simple properties cannont have sub-properties.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">isCompound</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span></div>

    <span class="k">def</span> <span class="nf">__get_sample_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts time in secs or frame number to sample index.</span>

<span class="sd">        :param time: time in seconds.</span>
<span class="sd">        :param frame: frame number.</span>
<span class="sd">        :return: sample index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">_COMPOUND_PROPERTY_VALUE_ERROR_</span><span class="p">)</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">()</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">getTimeSampling</span><span class="p">()</span>
        <span class="n">numSamples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">()</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">getNumSamples</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ts</span><span class="o">.</span><span class="n">getNearIndex</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="n">numSamples</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">frame</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ts</span><span class="o">.</span><span class="n">getNearIndex</span><span class="p">((</span><span class="n">frame</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">archive</span><span class="p">()</span><span class="o">.</span><span class="n">fps</span><span class="p">),</span> <span class="n">numSamples</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns dictionary of values stored on this property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_compound</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">samples</span><span class="p">)):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span>
                    <span class="k">print</span> <span class="s2">&quot;Bad value on sample:&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">err</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>

<div class="viewcode-block" id="Property.get_value"><a class="viewcode-back" href="../index.html#cask.Property.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a the value stored on this property for a given sample</span>
<span class="sd">        index, time or frame.</span>

<span class="sd">        Provide one of the following args. If none are provided, it will</span>
<span class="sd">        return the 0th value.</span>

<span class="sd">        :param index: sample index</span>
<span class="sd">        :param time: time in seconds</span>
<span class="sd">        :param frame: frame number (assumes 24fps, to change set on archive)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_compound</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">_COMPOUND_PROPERTY_VALUE_ERROR_</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">time</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">frame</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_sample_index</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">return</span> <span class="n">val</span></div>

<div class="viewcode-block" id="Property.set_value"><a class="viewcode-back" href="../index.html#cask.Property.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets a value on the property at a given index.</span>

<span class="sd">        Provide one of the following args. If none are provided, it will</span>
<span class="sd">        append to the end.</span>

<span class="sd">        :param index: sample index</span>
<span class="sd">        :param time: time in seconds</span>
<span class="sd">        :param frame: frame number (assumes 24fps, to change set on archive)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_compound</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">_COMPOUND_PROPERTY_VALUE_ERROR_</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">_delist</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">time</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">frame</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_sample_index</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Property.clear_properties"><a class="viewcode-back" href="../index.html#cask.Property.clear_properties">[docs]</a>    <span class="k">def</span> <span class="nf">clear_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clears the properties container.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prop_dict</span> <span class="o">=</span> <span class="n">DeepDict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Property</span><span class="p">)</span></div>

<div class="viewcode-block" id="Property.clear_values"><a class="viewcode-back" href="../index.html#cask.Property.clear_values">[docs]</a>    <span class="k">def</span> <span class="nf">clear_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clears the values container.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="Property.close"><a class="viewcode-back" href="../index.html#cask.Property.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Closes this property by removing references to internal OProperty.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">properties</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iobject</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Property.save"><a class="viewcode-back" href="../index.html#cask.Property.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Walks sub-tree and creates corresponding alembic OProperty classes,</span>
<span class="sd">        if they don&#39;t exist, and sets values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oobject</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_compound</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;.selfBnds&quot;</span><span class="p">,</span> <span class="s2">&quot;.childBnds&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">oobject</span><span class="o">.</span><span class="n">getMetaData</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;interpretation&quot;</span><span class="p">,</span> <span class="s2">&quot;box&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">python_to_imath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">oobject</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span>
                    <span class="k">print</span> <span class="s2">&quot;Error setting value on </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> \
                        <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">up</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">prop</span><span class="o">.</span><span class="n">iobject</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">prop</span><span class="o">.</span><span class="n">object</span><span class="p">()</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;.childBnds&quot;</span><span class="p">:</span>
                        <span class="n">prop</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">object</span><span class="p">()</span><span class="o">.</span><span class="n">oobject</span><span class="o">.</span><span class="n">getSchema</span><span class="p">()</span><span class="o">.</span><span class="n">getChildBoundsProperty</span><span class="p">()</span>
                    <span class="k">elif</span> <span class="n">prop</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;.userProperties&quot;</span><span class="p">:</span>
                        <span class="n">up</span> <span class="o">=</span> <span class="n">Property</span><span class="p">()</span>
                        <span class="n">up</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">object</span><span class="p">()</span><span class="o">.</span><span class="n">oobject</span><span class="o">.</span><span class="n">getSchema</span><span class="p">()</span><span class="o">.</span><span class="n">getUserProperties</span><span class="p">()</span>
                        <span class="n">up</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">prop</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">prop</span>
                        <span class="n">prop</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">up</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">prop</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
                <span class="n">prop</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
                <span class="n">prop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">del</span> <span class="n">prop</span>
                <span class="k">if</span> <span class="n">up</span><span class="p">:</span>
                    <span class="n">up</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    <span class="k">del</span> <span class="n">up</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div></div>

<div class="viewcode-block" id="Object"><a class="viewcode-back" href="../index.html#cask.Object">[docs]</a><span class="k">class</span> <span class="nc">Object</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base I/O Object class.&quot;&quot;&quot;</span>
    <span class="n">_sample_class</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iobject</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">time_sampling_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param iobject: Any alembic.Abc.IObject subclass object</span>
<span class="sd">        :param schema: Any alembic.Abc.ISchema subclass object</span>
<span class="sd">        :param time_sampling_id: The ID of the TimeSampling object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Object</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># init some private variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_isamples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_osamples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iobject</span> <span class="o">=</span> <span class="n">iobject</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span> <span class="o">=</span> <span class="n">schema</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_animated</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tsid</span> <span class="o">=</span> <span class="n">time_sampling_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prop_dict</span> <span class="o">=</span> <span class="n">DeepDict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Property</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_child_dict</span> <span class="o">=</span> <span class="n">DeepDict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Object</span><span class="p">)</span>

        <span class="c1"># init some stuff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_all</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__read_object</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;</span><span class="si">%s</span><span class="s1"> &quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="Object.get_item"><a class="viewcode-back" href="../index.html#cask.Object.get_item">[docs]</a>    <span class="k">def</span> <span class="nf">get_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;used for deep dict access&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">item</span><span class="p">]</span></div>

<div class="viewcode-block" id="Object.set_item"><a class="viewcode-back" href="../index.html#cask.Object.set_item">[docs]</a>    <span class="k">def</span> <span class="nf">set_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;used for deep dict access&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">__sample_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets this object&#39;s sample methods&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sample_class</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__get_iobject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets iobject&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iobject</span>

    <span class="k">def</span> <span class="nf">__set_iobject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iobject</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets iobject&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iobject</span> <span class="o">=</span> <span class="n">iobject</span>

    <span class="n">iobject</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_iobject</span><span class="p">,</span> <span class="n">__set_iobject</span><span class="p">,</span>
                       <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Internal Alembic IObject object.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__get_oobject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets oobject&quot;&quot;&quot;</span>
        
        <span class="c1"># Using OObject subclasses (like OXform) automatically</span>
        <span class="c1"># creates hidden Compound Properties (like .xform) which</span>
        <span class="c1"># results in name collisions when saving properties in cask.</span>
        <span class="c1"># Using OObjects avoids this problem, but we have to set</span>
        <span class="c1"># the metadata manually.</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
            <span class="n">meta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getMetaData</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">meta</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcCoreAbstract</span><span class="o">.</span><span class="n">MetaData</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">meta</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">Abc</span><span class="o">.</span><span class="n">OObject</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span> <span class="o">=</span> <span class="n">OOBJECTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">())</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
                    <span class="k">print</span> <span class="s2">&quot;OObject is missing parent:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">oobject</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                            <span class="n">meta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_sampling_id</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span> <span class="s2">&quot;OObject class not found for: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span>

    <span class="k">def</span> <span class="nf">__set_oobject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oobject</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets oobject&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="n">oobject</span>

    <span class="n">oobject</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_oobject</span><span class="p">,</span> <span class="n">__set_oobject</span><span class="p">,</span>
                       <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Internal Alembic OObject object.&quot;</span><span class="p">)</span>

    <span class="nd">@wrapped</span>
    <span class="k">def</span> <span class="nf">__get_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets schema&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getSchema</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span>

    <span class="k">def</span> <span class="nf">__set_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets schema&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span> <span class="o">=</span> <span class="n">schema</span>

    <span class="n">schema</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_schema</span><span class="p">,</span> <span class="n">__set_schema</span><span class="p">,</span>
                      <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Returns the Alembic schema object.&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Object.matches"><a class="viewcode-back" href="../index.html#cask.Object.matches">[docs]</a>    <span class="k">def</span> <span class="nf">matches</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">iobject</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if a given iobject type matches this type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">IOBJECTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">iobject</span><span class="o">.</span><span class="n">getMetaData</span><span class="p">())</span></div>

    <span class="k">def</span> <span class="nf">__get_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets parent&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">parent</span><span class="o">.</span><span class="n">getFullName</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">Top</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>

    <span class="k">def</span> <span class="nf">__set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets parent&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">!=</span> <span class="n">Top</span><span class="p">:</span>
            <span class="n">parent</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="n">parent</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_parent</span><span class="p">,</span> <span class="n">__set_parent</span><span class="p">,</span>
                      <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Parent object accessor.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets name&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_name&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="k">def</span> <span class="nf">__set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets name&quot;&quot;&quot;</span>
        <span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">,</span> <span class="s2">&quot;_child_dict&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">old</span> <span class="ow">and</span> <span class="n">old</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_child_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_child_dict</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">old</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_child_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="n">name</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_name</span><span class="p">,</span> <span class="n">__set_name</span><span class="p">,</span>
                    <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Set and get the name of the object.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__get_tsid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets time sampling id&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tsid</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">time_sampling_id</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tsid</span>

    <span class="k">def</span> <span class="nf">__set_tsid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tsid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets time sampling id&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tsid</span> <span class="o">=</span> <span class="n">tsid</span>

    <span class="n">time_sampling_id</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_tsid</span><span class="p">,</span> <span class="n">__set_tsid</span><span class="p">,</span>
                                <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Time sampling ID.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns metadata dict&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
            <span class="n">meta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getMetaData</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">meta</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">):</span>
                <span class="n">splits</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_ai_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;=&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span>

    <span class="k">def</span> <span class="nf">__set_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets metadata dict&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">metadata</span>

    <span class="n">metadata</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_metadata</span><span class="p">,</span> <span class="n">__set_metadata</span><span class="p">,</span>
                        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Metadata as a dict.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Object.archive"><a class="viewcode-back" href="../index.html#cask.Object.archive">[docs]</a>    <span class="k">def</span> <span class="nf">archive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the Archive for this object.&quot;&quot;&quot;</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">while</span> <span class="n">parent</span> <span class="ow">and</span> <span class="n">parent</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;Archive&quot;</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">return</span> <span class="n">parent</span></div>

<div class="viewcode-block" id="Object.path"><a class="viewcode-back" href="../index.html#cask.Object.path">[docs]</a>    <span class="k">def</span> <span class="nf">path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the full path/name of this object.&quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">while</span> <span class="n">obj</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;Top&quot;</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">return</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="Object.type"><a class="viewcode-back" href="../index.html#cask.Object.type">[docs]</a>    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the name of the class.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span></div>

<div class="viewcode-block" id="Object.add_child"><a class="viewcode-back" href="../index.html#cask.Object.add_child">[docs]</a>    <span class="k">def</span> <span class="nf">add_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a child object to this object.</span>

<span class="sd">        :param child: cask.Object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">child</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span></div>

    <span class="k">def</span> <span class="nf">__read_object</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;reads object, sets name&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">!=</span> <span class="n">Top</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns children sub-tree accessor. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_child_dict</span><span class="o">.</span><span class="n">visited</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getNumChildren</span><span class="p">()):</span>
                <span class="n">child</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">(</span>
                    <span class="n">iobject</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                    <span class="n">time_sampling_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_sampling_id</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_child_dict</span><span class="p">[</span><span class="n">child</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_child_dict</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Properties accessor.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prop_dict</span><span class="o">.</span><span class="n">visited</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
            <span class="n">props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getProperties</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">propertyheaders</span><span class="p">)):</span>
                <span class="n">prop</span> <span class="o">=</span> <span class="n">Property</span><span class="p">(</span>
                    <span class="n">iproperty</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">getProperty</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                    <span class="n">time_sampling_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_sampling_id</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_prop_dict</span><span class="p">[</span><span class="n">prop</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">prop</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prop_dict</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">samples</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns samples from the Alembic IObject.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_isamples</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">num_samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">getNumSamples</span><span class="p">()</span>
            <span class="n">schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_isamples</span> <span class="o">=</span> <span class="p">[</span><span class="n">schema</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isamples</span>

<div class="viewcode-block" id="Object.set_sample"><a class="viewcode-back" href="../index.html#cask.Object.set_sample">[docs]</a>    <span class="k">def</span> <span class="nf">set_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets an Alembic sample object on this object.</span>

<span class="sd">        *Do we want to expose samples at all? Should all data</span>
<span class="sd">        be set via seting values on properties, directly or with</span>
<span class="sd">        high level methods?</span>

<span class="sd">        :param sample: Alembic sample object.</span>
<span class="sd">        :param index: Index of the sample to set, or None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_osamples</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_class</span><span class="p">,</span>\
            <span class="s2">&quot;Can not set </span><span class="si">%s</span><span class="s2"> on </span><span class="si">%s</span><span class="s2"> object&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_osamples</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">sample</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_set_default_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="Object.is_leaf"><a class="viewcode-back" href="../index.html#cask.Object.is_leaf">[docs]</a>    <span class="k">def</span> <span class="nf">is_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if this object is a leaf node, i.e. it has no children.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="Object.is_animated"><a class="viewcode-back" href="../index.html#cask.Object.is_animated">[docs]</a>    <span class="k">def</span> <span class="nf">is_animated</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if any properties are not constant.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_animated</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">def</span> <span class="nf">_is_animated</span><span class="p">(</span><span class="n">prop</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;recursive check&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">prop</span><span class="o">.</span><span class="n">is_compound</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">prop</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">isConstant</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_is_animated</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">_is_animated</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">_is_animated</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_animated</span></div>

<div class="viewcode-block" id="Object.is_deforming"><a class="viewcode-back" href="../index.html#cask.Object.is_deforming">[docs]</a>    <span class="k">def</span> <span class="nf">is_deforming</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if the object has changing P values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;.geom/P&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">prop</span><span class="p">:</span>
                <span class="k">return</span> <span class="ow">not</span> <span class="n">prop</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">isConstant</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span></div>

<div class="viewcode-block" id="Object.start_frame"><a class="viewcode-back" href="../index.html#cask.Object.start_frame">[docs]</a>    <span class="k">def</span> <span class="nf">start_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param fps: Frames per second used to calculate the start frame</span>
<span class="sd">        (default 24.0)</span>

<span class="sd">        :return: Start frame as float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">time_sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getTimeSampling</span><span class="p">()</span>
            <span class="n">fps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">archive</span><span class="p">()</span><span class="o">.</span><span class="n">fps</span>
            <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">time_sample</span><span class="o">.</span><span class="n">getSampleTime</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">fps</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">start_frame</span><span class="p">()</span></div>

<div class="viewcode-block" id="Object.end_frame"><a class="viewcode-back" href="../index.html#cask.Object.end_frame">[docs]</a>    <span class="k">def</span> <span class="nf">end_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">24</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param fps: Frames per second used to calculate the end frame</span>
<span class="sd">        (default 24.0)</span>

<span class="sd">        :return: Last frame as float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">time_sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getTimeSampling</span><span class="p">()</span>
            <span class="n">num_samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="o">.</span><span class="n">getNumSamples</span><span class="p">()</span>
            <span class="n">fps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">archive</span><span class="p">()</span><span class="o">.</span><span class="n">fps</span>
            <span class="k">if</span> <span class="n">num_samples</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">time_sample</span><span class="o">.</span><span class="n">getSampleTime</span><span class="p">(</span><span class="n">num_samples</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">fps</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">time_sample</span><span class="o">.</span><span class="n">getSampleTime</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">fps</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">end_frame</span><span class="p">()</span></div>

<div class="viewcode-block" id="Object.global_matrix"><a class="viewcode-back" href="../index.html#cask.Object.global_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">global_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns world space matrix for this object.&quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">accum_xform</span><span class="p">(</span><span class="n">xform</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;recursive xform accum&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">Xform</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_iobject</span><span class="p">):</span>
                <span class="n">xform</span> <span class="o">*=</span> <span class="n">obj</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
        <span class="n">xform</span> <span class="o">=</span> <span class="n">imath</span><span class="o">.</span><span class="n">M44d</span><span class="p">()</span>
        <span class="n">xform</span><span class="o">.</span><span class="n">makeIdentity</span><span class="p">()</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">while</span> <span class="n">parent</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Archive</span><span class="p">,</span> <span class="n">Top</span><span class="p">]:</span>
            <span class="n">accum_xform</span><span class="p">(</span><span class="n">xform</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">return</span> <span class="n">xform</span></div>

<div class="viewcode-block" id="Object.clear_properties"><a class="viewcode-back" href="../index.html#cask.Object.clear_properties">[docs]</a>    <span class="k">def</span> <span class="nf">clear_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clears the internal properties container.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prop_dict</span> <span class="o">=</span> <span class="n">DeepDict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Property</span><span class="p">)</span></div>

<div class="viewcode-block" id="Object.clear_samples"><a class="viewcode-back" href="../index.html#cask.Object.clear_samples">[docs]</a>    <span class="k">def</span> <span class="nf">clear_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clears the internal samples container.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_isamples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_osamples</span> <span class="o">=</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="Object.clear_children"><a class="viewcode-back" href="../index.html#cask.Object.clear_children">[docs]</a>    <span class="k">def</span> <span class="nf">clear_children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clears the internal children container.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_child_dict</span> <span class="o">=</span> <span class="n">DeepDict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Object</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">clear_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_properties</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_samples</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_children</span><span class="p">()</span>

<div class="viewcode-block" id="Object.close"><a class="viewcode-back" href="../index.html#cask.Object.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Closes this object by removing references to internal OObject.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;Archive&#39;</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iobject</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oobject</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_klass</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_all</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">del</span> <span class="n">prop</span></div>

<div class="viewcode-block" id="Object.save"><a class="viewcode-back" href="../index.html#cask.Object.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Walks child and property sub-trees creating OObjects as necessary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oobject</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">del</span> <span class="n">prop</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_osamples</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_default_sample</span><span class="p">()</span>
        <span class="c1"># OCameras have no getSchema method, properties written explicitly</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Camera&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">iobject</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_osamples</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Light&#39;</span> \
                   <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">==</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">CameraSample</span><span class="p">:</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">getSchema</span><span class="p">()</span><span class="o">.</span><span class="n">setCameraSample</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">getSchema</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">print</span> <span class="s2">&quot;Error setting sample on </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> \
                    <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">sample</span>
        <span class="k">del</span> <span class="n">obj</span></div></div>

<div class="viewcode-block" id="Top"><a class="viewcode-back" href="../index.html#cask.Top">[docs]</a><span class="k">class</span> <span class="nc">Top</span><span class="p">(</span><span class="n">Object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Alembic Top Object.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">archive</span><span class="p">,</span> <span class="n">iobject</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Top</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">iobject</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">proxy</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_top</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oobject</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Top.matches"><a class="viewcode-back" href="../index.html#cask.Top.matches">[docs]</a>    <span class="k">def</span> <span class="nf">matches</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">iobject</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns True if iobject is a Top object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">iobject</span><span class="o">.</span><span class="n">__class__</span> <span class="o">==</span> <span class="n">cls</span><span class="o">.</span><span class="n">__class__</span></div>

<div class="viewcode-block" id="Top.is_leaf"><a class="viewcode-back" href="../index.html#cask.Top.is_leaf">[docs]</a>    <span class="k">def</span> <span class="nf">is_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns False.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">False</span></div>

<div class="viewcode-block" id="Top.path"><a class="viewcode-back" href="../index.html#cask.Top.path">[docs]</a>    <span class="k">def</span> <span class="nf">path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the full path/name of this object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;/&quot;</span></div>

    <span class="k">def</span> <span class="nf">__get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;ABC&quot;</span>

    <span class="k">def</span> <span class="nf">__set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Can not set name on Top object.&quot;</span><span class="p">)</span>

    <span class="n">name</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_name</span><span class="p">,</span> <span class="n">__set_name</span><span class="p">,</span>
                    <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Returns the object name, which for Top is always ABC&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Xform"><a class="viewcode-back" href="../index.html#cask.Xform">[docs]</a><span class="k">class</span> <span class="nc">Xform</span><span class="p">(</span><span class="n">Object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Xform I/O Object subclass.&quot;&quot;&quot;</span>
    <span class="n">_sample_class</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">XformSample</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Xform</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Xform.matrix"><a class="viewcode-back" href="../index.html#cask.Xform.matrix">[docs]</a>    <span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the xform matrix value for a given index.</span>

<span class="sd">        :param index: Sample index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">getMatrix</span><span class="p">()</span></div>

<div class="viewcode-block" id="Xform.set_scale"><a class="viewcode-back" href="../index.html#cask.Xform.set_scale">[docs]</a>    <span class="k">def</span> <span class="nf">set_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates an internal XformSample object and sets the scale value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">imath</span><span class="o">.</span><span class="n">V3d</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">imath</span><span class="o">.</span><span class="n">V3d</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">xform_sample</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">XformSample</span><span class="p">()</span>
        <span class="n">xform_sample</span><span class="o">.</span><span class="n">setScale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_sample</span><span class="p">(</span><span class="n">xform_sample</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="PolyMesh"><a class="viewcode-back" href="../index.html#cask.PolyMesh">[docs]</a><span class="k">class</span> <span class="nc">PolyMesh</span><span class="p">(</span><span class="n">Object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;PolyMesh I/O Object subclass.&quot;&quot;&quot;</span>
    <span class="n">_sample_class</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">OPolyMeshSchemaSample</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PolyMesh</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="SubD"><a class="viewcode-back" href="../index.html#cask.SubD">[docs]</a><span class="k">class</span> <span class="nc">SubD</span><span class="p">(</span><span class="n">Object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;SubD I/O Object subclass.&quot;&quot;&quot;</span>
    <span class="n">_sample_class</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">OSubDSchemaSample</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SubD</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceSet"><a class="viewcode-back" href="../index.html#cask.FaceSet">[docs]</a><span class="k">class</span> <span class="nc">FaceSet</span><span class="p">(</span><span class="n">Object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FaceSet I/O Object subclass.&quot;&quot;&quot;</span>
    <span class="n">_sample_class</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">OFaceSetSchemaSample</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FaceSet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Curve"><a class="viewcode-back" href="../index.html#cask.Curve">[docs]</a><span class="k">class</span> <span class="nc">Curve</span><span class="p">(</span><span class="n">Object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Curve I/O Object subclass.&quot;&quot;&quot;</span>
    <span class="n">_sample_class</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">OCurvesSchemaSample</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Curve</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Camera"><a class="viewcode-back" href="../index.html#cask.Camera">[docs]</a><span class="k">class</span> <span class="nc">Camera</span><span class="p">(</span><span class="n">Object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Camera I/O Object subclass.&quot;&quot;&quot;</span>
    <span class="n">_sample_class</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">CameraSample</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Camera</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_default_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_sample</span><span class="p">(</span><span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">CameraSample</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="NuPatch"><a class="viewcode-back" href="../index.html#cask.NuPatch">[docs]</a><span class="k">class</span> <span class="nc">NuPatch</span><span class="p">(</span><span class="n">Object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;NuPath I/O Object subclass.&quot;&quot;&quot;</span>
    <span class="n">_sample_class</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">ONuPatchSchemaSample</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NuPatch</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Material"><a class="viewcode-back" href="../index.html#cask.Material">[docs]</a><span class="k">class</span> <span class="nc">Material</span><span class="p">(</span><span class="n">Object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Material I/O Object subclass.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Material</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Light"><a class="viewcode-back" href="../index.html#cask.Light">[docs]</a><span class="k">class</span> <span class="nc">Light</span><span class="p">(</span><span class="n">Object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Light I/O Object subclass.&quot;&quot;&quot;</span>
    <span class="n">_sample_class</span> <span class="o">=</span> <span class="n">alembic</span><span class="o">.</span><span class="n">AbcGeom</span><span class="o">.</span><span class="n">CameraSample</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Light</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<span class="k">class</span> <span class="nc">Points</span><span class="p">(</span><span class="n">Object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Points I/O Object subclass.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Points</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Cask 1.0.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2012-2016, Sony Pictures Imageworks Inc. and Industrial Light &amp; Magic, a division of Lucasfilm Entertainment Company Ltd..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4b1.
    </div>
  </body>
</html>